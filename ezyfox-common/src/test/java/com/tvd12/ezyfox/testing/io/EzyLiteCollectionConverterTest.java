package com.tvd12.ezyfox.testing.io;

import com.tvd12.ezyfox.builder.EzyArrayBuilder;
import com.tvd12.ezyfox.collect.Lists;
import com.tvd12.ezyfox.entity.EzyArray;
import com.tvd12.ezyfox.factory.EzyEntityFactory;
import com.tvd12.ezyfox.io.EzyCollectionConverter;
import com.tvd12.ezyfox.io.EzySimpleCollectionConverter;
import com.tvd12.ezyfox.io.EzySingletonCollectionConverter;
import com.tvd12.ezyfox.sercurity.EzyBase64;
import com.tvd12.ezyfox.testing.CommonBaseTest;
import org.testng.annotations.Test;

import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.Collection;

import static org.testng.Assert.assertEquals;

public class EzyLiteCollectionConverterTest extends CommonBaseTest {

    private final EzyCollectionConverter collectionConverter;

    public EzyLiteCollectionConverterTest() {
        super();
        this.collectionConverter = EzySingletonCollectionConverter.getInstance();
    }

    //    @Test
    public void test() {
        Collection<Boolean> booleans = Lists.newArrayList(true, false, true);
        assertEquals(collectionConverter.toArray(booleans, Boolean.class),
            new Boolean[]{true, false, true});

        Collection<Byte> bytes = Lists.newArrayList((byte) 1, (byte) 2, (byte) 3);
        assertEquals(collectionConverter.toArray(bytes, Byte.class),
            new Byte[]{(byte) 1, (byte) 2, (byte) 3});

        Collection<Character> characters = Lists.newArrayList('a', 'b', 'c');
        assertEquals(collectionConverter.toArray(characters, Character.class),
            new Character[]{'a', 'b', 'c'});

        Collection<Double> doubles = Lists.newArrayList(1D, 2D, 3D);
        assertEquals(collectionConverter.toArray(doubles, Double.class),
            new Double[]{1D, 2D, 3D});

        Collection<Float> floats = Lists.newArrayList(1F, 2F, 3F);
        assertEquals(collectionConverter.toArray(floats, Float.class),
            new Float[]{1F, 2F, 3F});

        Collection<Integer> integers = Lists.newArrayList(1, 2, 3);
        assertEquals(collectionConverter.toArray(integers, Integer.class),
            new Integer[]{1, 2, 3});

        Collection<Long> longs = Lists.newArrayList(1L, 2L, 3L);
        assertEquals(collectionConverter.toArray(longs, Long.class),
            new Long[]{1L, 2L, 3L});

        Collection<Short> shorts = Lists.newArrayList((short) 1, (short) 2, (short) 3);
        assertEquals(collectionConverter.toArray(shorts, Short.class),
            new Short[]{(short) 1, (short) 2, (short) 3});

        Collection<String> strings = Lists.newArrayList("a", "b", "c");
        assertEquals(collectionConverter.toArray(strings, String.class),
            new String[]{"a", "b", "c"});
    }

    //    @Test
    public void test1() {
        Collection<Boolean> booleans = Lists.newArrayList(true, false, true);
        assertEquals(collectionConverter.toArray(booleans, boolean.class),
            new boolean[]{true, false, true});

        Collection<Byte> bytes = Lists.newArrayList((byte) 1, (byte) 2, (byte) 3);
        assertEquals(collectionConverter.toArray(bytes, byte.class),
            new byte[]{(byte) 1, (byte) 2, (byte) 3});

        Collection<Character> characters = Lists.newArrayList('a', 'b', 'c');
        assertEquals(collectionConverter.toArray(characters, char.class),
            new char[]{'a', 'b', 'c'});

        Collection<Double> doubles = Lists.newArrayList(1D, 2D, 3D);
        assertEquals(collectionConverter.toArray(doubles, double.class),
            new double[]{1D, 2D, 3D});

        Collection<Float> floats = Lists.newArrayList(1F, 2F, 3F);
        assertEquals(collectionConverter.toArray(floats, float.class),
            new float[]{1F, 2F, 3F});

        Collection<Integer> integers = Lists.newArrayList(1, 2, 3);
        assertEquals(collectionConverter.toArray(integers, int.class),
            new int[]{1, 2, 3});

        Collection<Long> longs = Lists.newArrayList(1L, 2L, 3L);
        assertEquals(collectionConverter.toArray(longs, long.class),
            new long[]{1L, 2L, 3L});

        Collection<Short> shorts = Lists.newArrayList((short) 1, (short) 2, (short) 3);
        assertEquals(collectionConverter.toArray(shorts, short.class),
            new short[]{(short) 1, (short) 2, (short) 3});

        Collection<String> strings = Lists.newArrayList("a", "b", "c");
        assertEquals(collectionConverter.toArray(strings, String.class),
            new String[]{"a", "b", "c"});
    }

    @Test
    public void test2() {
        Collection<EzyArray> booleanss = new ArrayList<>();
        booleanss.add(newArrayBuilder().append(true, false, true).build());
        booleanss.add(newArrayBuilder().append(false, true, false).build());
        assertEquals((Object) collectionConverter.toArray(booleanss, boolean[].class),
            new boolean[][]{{true, false, true}, {false, true, false}});

        Collection<EzyArray> bytess = new ArrayList<>();
        bytess.add(newArrayBuilder().append((byte) 1, (byte) 2, (byte) 3).build());
        bytess.add(newArrayBuilder().append((byte) 4, (byte) 5, (byte) 6).build());
        assertEquals((Object) collectionConverter.toArray(bytess, byte[].class),
            new byte[][]{{(byte) 1, (byte) 2, (byte) 3}, {(byte) 4, (byte) 5, (byte) 6}});

        Collection<EzyArray> characterss = new ArrayList<>();
        characterss.add(newArrayBuilder().append('a', 'b', 'c').build());
        characterss.add(newArrayBuilder().append('d', 'e', 'f').build());
        assertEquals((Object) collectionConverter.toArray(characterss, char[].class),
            new char[][]{{'a', 'b', 'c'}, {'d', 'e', 'f'}});

        Collection<EzyArray> doubless = new ArrayList<>();
        doubless.add(newArrayBuilder().append(1D, 2D, 3D).build());
        doubless.add(newArrayBuilder().append(4D, 5D, 6D).build());
        assertEquals((Object) collectionConverter.toArray(doubless, double[].class),
            new double[][]{{1D, 2D, 3D}, {4D, 5D, 6D}});

        Collection<EzyArray> floatss = new ArrayList<>();
        floatss.add(newArrayBuilder().append(1F, 2F, 3F).build());
        floatss.add(newArrayBuilder().append(4F, 5F, 6F).build());
        assertEquals((Object) collectionConverter.toArray(floatss, float[].class),
            new float[][]{{1F, 2F, 3F}, {4F, 5F, 6F}});

        Collection<EzyArray> integerss = new ArrayList<>();
        integerss.add(newArrayBuilder().append(1, 2, 3).build());
        integerss.add(newArrayBuilder().append(4, 5, 6).build());
        assertEquals((Object) collectionConverter.toArray(integerss, int[].class),
            new int[][]{{1, 2, 3}, {4, 5, 6}});

        Collection<EzyArray> longss = new ArrayList<>();
        longss.add(newArrayBuilder().append(1L, 2L, 3L).build());
        longss.add(newArrayBuilder().append(4L, 5L, 6L).build());
        assertEquals((Object) collectionConverter.toArray(longss, long[].class),
            new long[][]{{1L, 2L, 3L}, {4L, 5L, 6L}});

        Collection<EzyArray> shortss = new ArrayList<>();
        shortss.add(newArrayBuilder().append((short) 1, (short) 2, (short) 3).build());
        shortss.add(newArrayBuilder().append((short) 4, (short) 5, (short) 6).build());
        assertEquals((Object) collectionConverter.toArray(shortss, short[].class),
            new short[][]{{(short) 1, (short) 2, (short) 3}, {(short) 4, (short) 5, (short) 6}});

        Collection<EzyArray> stringss = new ArrayList<>();
        stringss.add(newArrayBuilder().append("a", "b", "c").build());
        stringss.add(newArrayBuilder().append("d", "e", "f").build());
        assertEquals((Object) collectionConverter.toArray(stringss, String[].class),
            new String[][]{{"a", "b", "c"}, {"d", "e", "f"}});
    }


    @Test
    public void test3() {
        Collection<EzyArray> booleanss = new ArrayList<>();
        booleanss.add(newArrayBuilder().append(true, false, true).build());
        booleanss.add(newArrayBuilder().append(false, true, false).build());
        assertEquals((Object) collectionConverter.toArray(booleanss, Boolean[].class),
            new Boolean[][]{{true, false, true}, {false, true, false}});

        Collection<EzyArray> bytess = new ArrayList<>();
        bytess.add(newArrayBuilder().append((byte) 1, (byte) 2, (byte) 3).build());
        bytess.add(newArrayBuilder().append((byte) 4, (byte) 5, (byte) 6).build());
        assertEquals((Object) collectionConverter.toArray(bytess, Byte[].class),
            new Byte[][]{{(byte) 1, (byte) 2, (byte) 3}, {(byte) 4, (byte) 5, (byte) 6}});

        Collection<EzyArray> characterss = new ArrayList<>();
        characterss.add(newArrayBuilder().append('a', 'b', 'c').build());
        characterss.add(newArrayBuilder().append('d', 'e', 'f').build());
        assertEquals((Object) collectionConverter.toArray(characterss, Character[].class),
            new Character[][]{{'a', 'b', 'c'}, {'d', 'e', 'f'}});

        Collection<EzyArray> doubless = new ArrayList<>();
        doubless.add(newArrayBuilder().append(1D, 2D, 3D).build());
        doubless.add(newArrayBuilder().append(4D, 5D, 6D).build());
        assertEquals((Object) collectionConverter.toArray(doubless, Double[].class),
            new Double[][]{{1D, 2D, 3D}, {4D, 5D, 6D}});

        Collection<EzyArray> floatss = new ArrayList<>();
        floatss.add(newArrayBuilder().append(1F, 2F, 3F).build());
        floatss.add(newArrayBuilder().append(4F, 5F, 6F).build());
        assertEquals((Object) collectionConverter.toArray(floatss, Float[].class),
            new Float[][]{{1F, 2F, 3F}, {4F, 5F, 6F}});

        Collection<EzyArray> integerss = new ArrayList<>();
        integerss.add(newArrayBuilder().append(1, 2, 3).build());
        integerss.add(newArrayBuilder().append(4, 5, 6).build());
        assertEquals((Object) collectionConverter.toArray(integerss, Integer[].class),
            new Integer[][]{{1, 2, 3}, {4, 5, 6}});

        Collection<EzyArray> longss = new ArrayList<>();
        longss.add(newArrayBuilder().append(1L, 2L, 3L).build());
        longss.add(newArrayBuilder().append(4L, 5L, 6L).build());
        assertEquals((Object) collectionConverter.toArray(longss, Long[].class),
            new Long[][]{{1L, 2L, 3L}, {4L, 5L, 6L}});

        Collection<EzyArray> shortss = new ArrayList<>();
        shortss.add(newArrayBuilder().append((short) 1, (short) 2, (short) 3).build());
        shortss.add(newArrayBuilder().append((short) 4, (short) 5, (short) 6).build());
        assertEquals((Object) collectionConverter.toArray(shortss, Short[].class),
            new Short[][]{{(short) 1, (short) 2, (short) 3}, {(short) 4, (short) 5, (short) 6}});

        Collection<EzyArray> stringss = new ArrayList<>();
        stringss.add(newArrayBuilder().append("a", "b", "c").build());
        stringss.add(newArrayBuilder().append("d", "e", "f").build());
        assertEquals((Object) collectionConverter.toArray(stringss, String[].class),
            new String[][]{{"a", "b", "c"}, {"d", "e", "f"}});
    }

    @Test
    public void test5() {
        try {
            Method method = EzySimpleCollectionConverter.class
                .getDeclaredMethod("toArray", Object.class, Class.class);
            method.setAccessible(true);
            method.invoke(collectionConverter, "abc", String.class);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Test(expectedExceptions = {IllegalArgumentException.class})
    public void test6() {
        EzySingletonCollectionConverter.getInstance().toArray(Lists.newArrayList(), Void.class);
    }

    @Test
    public void test7() {
        newArrayBuilder()
            .append(new byte[]{1, 2, 3}, new byte[]{4, 5, 6}, new byte[]{7, 8, 9})
            .build();
        EzyArray array = EzyEntityFactory.create(EzyArrayBuilder.class)
            .append(EzyBase64.encode2utf(new byte[]{1, 2, 3}))
            .append(EzyBase64.encode2utf(new byte[]{4, 5, 6}))
            .append(EzyBase64.encode2utf(new byte[]{7, 8, 9}))
            .build();
        assertEquals((Object) array.toArray(byte[].class), new byte[][]{
            {1, 2, 3}, {4, 5, 6}, {7, 8, 9}
        });
    }
}
